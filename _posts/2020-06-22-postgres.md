---
layout: post
title:  "Команды PostgreSQL"
crawlertitle: "This is our first post"
summary: "Команды PostgreSQL"
date:   2022-08-28 23:09:47 +0700
categories: posts
tags: ['Дата аналитика']
#author: Felipe
---


Шпаргалка PostgreSQL - общие команды и операторы PostgreSQL, которые позволяют быстро и эффективно работать с PostgreSQL.

## Вход под пользователем postgres.

{% highlight python %}
sudo su postgres
{% endhighlight %}

Работать с PosgreSQL можно как в интерактивном режиме, так и из командной строки. Программа — psql.

## Основные команды PostgreSQL в интерактивном режиме:


* \connect db_name – подключиться к базе с именем db_name
* \du – список пользователей
* \dp (или \z) – список таблиц, представлений, последовательностей, прав доступа к ним
* \di – индексы
* \ds – последовательности
* \dt – список таблиц
* \dt+ — список всех таблиц с описанием
* \dt *s* — список всех таблиц, содержащих s в имени
* \dv – представления
* \dS – системные таблицы
* \d+ – описание таблицы
* \o – пересылка результатов запроса в файл
* \l – список баз данных
* \i – читать входящие данные из файла
* \e – открывает текущее содержимое буфера запроса в редакторе (если иное не указано в окружении переменной EDITOR, то будет использоваться по умолчанию vi)
* \d “table_name” – описание таблицы
* \i запуск команды из внешнего файла, например \i /my/directory/my.sql
* \pset – команда настройки параметров форматирования
* \echo – выводит сообщение
* \set – устанавливает значение переменной среды. Без параметров выводит список текущих переменных (\unset – удаляет).
* \? – справочник psql
* \help – справочник SQL
* \q (или Ctrl+D) – выход с программы

## Работа с PostgreSQL из командной строки:

* -c (или –command) – запуск команды SQL без выхода в интерактивный режим
* -f file.sql — выполнение команд из файла file.sql
* -l (или –list) – выводит список доступных баз данных
* -U (или –username) – указываем имя пользователя (например postgres)
* -W (или –password) – приглашение на ввод пароля
* -d dbname — подключение к БД dbname
* -h – имя хоста (сервера)
* -s – пошаговый режим, то есть, нужно будет подтверждать все команды
* –S – однострочный режим, то есть, переход на новую строку будет выполнять запрос (избавляет от ; в конце конструкции SQL)
* -V – версия PostgreSQL без входа в интерактивный режим

## Примеры:

{% highlight python %}
psql --username=postgres --dbname=postgres
{% endhighlight %}

Cокращенный вариант этой команды:

{% highlight python %}
psql -U postgres -d postgres
{% endhighlight %}

## Утилиты (программы) PosgreSQL:


* createdb и dropdb – создание и удаление базы данных (соответственно)
* createuser и dropuser – создание и пользователя (соответственно)
* pg_ctl – программа предназначенная для решения общих задач управления (запуск, останов, настройка параметров и т.д.)
* postmaster – многопользовательский серверный модуль PostgreSQL (настройка уровней отладки, портов, каталогов данных)
* initdb – создание новых кластеров PostgreSQL
* initlocation – программа для создания каталогов для вторичного хранения баз данных
* vacuumdb – физическое и аналитическое сопровождение БД
* pg_dump – архивация и восстановление данных
* pg_dumpall – резервное копирование всего кластера PostgreSQL
* pg_restore – восстановление БД из архивов (.tar, .tar.gz)


## Список наиболее часто используемых опций:


* -h host — хост, если не указан то используется localhost или значение из переменной окружения PGHOST.
* -p port — порт, если не указан то используется 5432 или значение из переменной окружения PGPORT.
* -u — пользователь, если не указан то используется текущий пользователь, также значение можно указать в переменной окружения PGUSER.
* -a, —data-only — дамп только данных, по-умолчанию сохраняются данные и схема.
* -b — включать в дамп большие объекты (blog’и).
* -s, —schema-only — дамп только схемы.
* -C, —create — добавляет команду для создания БД.
* -c — добавляет команды для удаления (drop) объектов (таблиц, видов и т.д.).
* -O — не добавлять команды для установки владельца объекта (таблиц, видов и т.д.).
* -F, —format {c|t|p} — выходной формат дампа, custom, tar, или plain text.
* -t, —table=TABLE — указываем определенную таблицу для дампа.
* -v, —verbose — вывод подробной информации.
* -D, —attribute-inserts — дамп используя команду INSERT с списком имен свойств.

[Шпаргалка по основным командам PostgreSQL](https://www.oslogic.ru/knowledge/598/shpargalka-po-osnovnym-komandam-postgresql/)


